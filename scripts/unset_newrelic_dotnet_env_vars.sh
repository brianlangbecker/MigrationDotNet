#!/bin/bash
#
# Script to unset all New Relic .NET Agent environment variables
# Usage: source unset_newrelic_dotnet_env_vars.sh
#

echo "Unsetting New Relic .NET Agent environment variables..."

# Function to unset variables with a common prefix
unset_vars_with_prefix() {
  local prefix=$1
  for var in $(env | grep "^$prefix" | cut -d= -f1); do
    unset "$var"
    echo "Unset $var"
  done
}

# Core Configuration
unset NEW_RELIC_LICENSE_KEY
unset NEW_RELIC_APP_NAME
unset NEWRELIC_LICENSE_KEY
unset NEWRELIC_APP_NAME
unset CORECLR_NEWRELIC_HOME
unset NEWRELIC_HOME
unset NEW_RELIC_HOME
unset NEW_RELIC_INSTALL_PATH
unset NEW_RELIC_AGENT_ENABLED
unset NEWRELIC_AGENT_ENABLED
unset NEW_RELIC_CONFIG_FILE
unset NEWRELIC_CONFIG_FILE
unset NEW_RELIC_CONFIG_FILE_PATH
unset NEWRELIC_CONFIG_FILE_PATH

# Application Settings
unset NEW_RELIC_APPLICATION_LOGGING_ENABLED
unset NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED
unset NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED
unset NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED
unset NEW_RELIC_APDEX_T
unset NEW_RELIC_APP_POOL
unset NEW_RELIC_ASP
unset NEW_RELIC_AUTO_START_PROFILER
unset NEW_RELIC_AUTO_START_TRACER
unset NEW_RELIC_AUTO_INSTRUMENT
unset NEW_RELIC_BROWSER_MONITORING_AUTO_INSTRUMENT
unset NEWRELIC_BROWSER_MONITORING_AUTO_INSTRUMENT
unset NEW_RELIC_HIGH_SECURITY
unset NEWRELIC_HIGH_SECURITY
unset NEW_RELIC_LABELS
unset NEWRELIC_LABELS
unset NEW_RELIC_MONITOR_MODE
unset NEWRELIC_MONITOR_MODE

# Transaction Naming
unset NEW_RELIC_TRANSACTION_NAMING_PRIORITY
unset NEW_RELIC_TRANSACTION_TRACER_ENABLED
unset NEWRELIC_TRANSACTION_TRACER_ENABLED
unset NEW_RELIC_TRANSACTION_TRACER_EXPLAIN_ENABLED
unset NEWRELIC_TRANSACTION_TRACER_EXPLAIN_ENABLED
unset NEW_RELIC_TRANSACTION_TRACER_EXPLAIN_THRESHOLD
unset NEWRELIC_TRANSACTION_TRACER_EXPLAIN_THRESHOLD
unset NEW_RELIC_TRANSACTION_TRACER_RECORD_SQL
unset NEWRELIC_TRANSACTION_TRACER_RECORD_SQL
unset NEW_RELIC_TRANSACTION_TRACER_STACK_TRACE_THRESHOLD
unset NEWRELIC_TRANSACTION_TRACER_STACK_TRACE_THRESHOLD
unset NEW_RELIC_TRANSACTION_TRACER_THRESHOLD
unset NEWRELIC_TRANSACTION_TRACER_THRESHOLD
unset NEW_RELIC_TRANSACTION_EVENTS_ENABLED
unset NEWRELIC_TRANSACTION_EVENTS_ENABLED
unset NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED
unset NEWRELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED
unset NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED
unset NEWRELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED
unset NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_PER_MINUTE
unset NEWRELIC_TRANSACTION_EVENTS_MAX_SAMPLES_PER_MINUTE

# Attributes
unset NEW_RELIC_ATTRIBUTES_EXCLUDE
unset NEWRELIC_ATTRIBUTES_EXCLUDE
unset NEW_RELIC_ATTRIBUTES_INCLUDE
unset NEWRELIC_ATTRIBUTES_INCLUDE
unset NEW_RELIC_ATTRIBUTES_ENABLED
unset NEWRELIC_ATTRIBUTES_ENABLED
unset NEW_RELIC_CAPTURE_PARAMS
unset NEWRELIC_CAPTURE_PARAMS
unset NEW_RELIC_CAPTURE_ATTRIBUTES
unset NEWRELIC_CAPTURE_ATTRIBUTES

# Error Collection
unset NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED
unset NEWRELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED
unset NEW_RELIC_ERROR_COLLECTOR_ENABLED
unset NEWRELIC_ERROR_COLLECTOR_ENABLED
unset NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERRORS
unset NEWRELIC_ERROR_COLLECTOR_IGNORE_ERRORS
unset NEW_RELIC_ERROR_COLLECTOR_IGNORE_CLASSES
unset NEWRELIC_ERROR_COLLECTOR_IGNORE_CLASSES
unset NEW_RELIC_ERROR_COLLECTOR_IGNORE_HTTP_STATUS_CODES
unset NEWRELIC_ERROR_COLLECTOR_IGNORE_HTTP_STATUS_CODES
unset NEW_RELIC_ERROR_COLLECTOR_IGNORE_STATUS_CODES
unset NEWRELIC_ERROR_COLLECTOR_IGNORE_STATUS_CODES
unset NEW_RELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED
unset NEWRELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED
unset NEW_RELIC_ERROR_COLLECTOR_RECORD_DATABASE_ERRORS
unset NEWRELIC_ERROR_COLLECTOR_RECORD_DATABASE_ERRORS

# Analytics Events
unset NEW_RELIC_ANALYTICS_EVENTS_ENABLED
unset NEWRELIC_ANALYTICS_EVENTS_ENABLED
unset NEW_RELIC_ANALYTICS_EVENTS_MAX_SAMPLES_STORED
unset NEWRELIC_ANALYTICS_EVENTS_MAX_SAMPLES_STORED
unset NEW_RELIC_ANALYTICS_EVENTS_CAPTURE_ATTRIBUTES
unset NEWRELIC_ANALYTICS_EVENTS_CAPTURE_ATTRIBUTES
unset NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED
unset NEWRELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED
unset NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED
unset NEWRELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED

# Browser Monitoring
unset NEW_RELIC_BROWSER_KEY
unset NEWRELIC_BROWSER_KEY
unset NEW_RELIC_BROWSER_MONITORING_AUTO_INSTRUMENT
unset NEWRELIC_BROWSER_MONITORING_AUTO_INSTRUMENT
unset NEW_RELIC_BROWSER_MONITORING_CAPTURE_ATTRIBUTES
unset NEWRELIC_BROWSER_MONITORING_CAPTURE_ATTRIBUTES
unset NEW_RELIC_BROWSER_MONITORING_DEBUG
unset NEWRELIC_BROWSER_MONITORING_DEBUG
unset NEW_RELIC_BROWSER_MONITORING_SSL
unset NEWRELIC_BROWSER_MONITORING_SSL
unset NEW_RELIC_BROWSER_APPLICATION_ID
unset NEWRELIC_BROWSER_APPLICATION_ID

# SQL Tracing
unset NEW_RELIC_SLOW_SQL_ENABLED
unset NEWRELIC_SLOW_SQL_ENABLED
unset NEW_RELIC_EXPLAIN_ENABLED
unset NEWRELIC_EXPLAIN_ENABLED
unset NEW_RELIC_EXPLAIN_THRESHOLD
unset NEWRELIC_EXPLAIN_THRESHOLD
unset NEW_RELIC_MAX_SQL_SAMPLES
unset NEWRELIC_MAX_SQL_SAMPLES
unset NEW_RELIC_RECORD_SQL
unset NEWRELIC_RECORD_SQL

# Logging
unset NEW_RELIC_LOG
unset NEWRELIC_LOG
unset NEW_RELIC_LOG_LEVEL
unset NEWRELIC_LOG_LEVEL
unset NEW_RELIC_LOG_DIRECTORY
unset NEWRELIC_LOG_DIRECTORY
unset NEW_RELIC_LOG_FILE_NAME
unset NEWRELIC_LOG_FILE_NAME
unset NEW_RELIC_LOG_FILE_COUNT
unset NEWRELIC_LOG_FILE_COUNT
unset NEW_RELIC_LOG_FILE_SIZE
unset NEWRELIC_LOG_FILE_SIZE
unset NEW_RELIC_LOG_CONSOLE
unset NEWRELIC_LOG_CONSOLE
unset NEW_RELIC_LOG_DAILY
unset NEWRELIC_LOG_DAILY
unset NEW_RELIC_AUDIT_MODE
unset NEWRELIC_AUDIT_MODE

# Network/Communication
unset NEW_RELIC_PROXY_HOST
unset NEWRELIC_PROXY_HOST
unset NEW_RELIC_PROXY_PORT
unset NEWRELIC_PROXY_PORT
unset NEW_RELIC_PROXY_USER
unset NEWRELIC_PROXY_USER
unset NEW_RELIC_PROXY_PASSWORD
unset NEWRELIC_PROXY_PASSWORD
unset NEW_RELIC_PROXY_URISTRING
unset NEWRELIC_PROXY_URISTRING
unset NEW_RELIC_PROXY_DOMAIN
unset NEWRELIC_PROXY_DOMAIN
unset NEW_RELIC_HOST
unset NEWRELIC_HOST
unset NEW_RELIC_PORT
unset NEWRELIC_PORT
unset NEW_RELIC_DAEMON_PORT
unset NEWRELIC_DAEMON_PORT
unset NEW_RELIC_PROFILER_TCP_COMM_ADDRESS
unset NEWRELIC_PROFILER_TCP_COMM_ADDRESS
unset NEW_RELIC_USE_SSL
unset NEWRELIC_USE_SSL
unset NEW_RELIC_SEND_ENVIRONMENT_INFO
unset NEWRELIC_SEND_ENVIRONMENT_INFO
unset NEW_RELIC_CA_BUNDLE_PATH
unset NEWRELIC_CA_BUNDLE_PATH
unset NEW_RELIC_CERT_FILE
unset NEWRELIC_CERT_FILE
unset NEW_RELIC_CERT_KEY_FILE
unset NEWRELIC_CERT_KEY_FILE
unset NEW_RELIC_CERT_PASSPHRASE
unset NEWRELIC_CERT_PASSPHRASE

# Distributed Tracing
unset NEW_RELIC_DISTRIBUTED_TRACING_ENABLED
unset NEWRELIC_DISTRIBUTED_TRACING_ENABLED
unset NEW_RELIC_DISTRIBUTED_TRACING_EXCLUDE_NEWRELIC_HEADER
unset NEWRELIC_DISTRIBUTED_TRACING_EXCLUDE_NEWRELIC_HEADER
unset NEW_RELIC_SPAN_EVENTS_ENABLED
unset NEWRELIC_SPAN_EVENTS_ENABLED
unset NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED
unset NEWRELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED
unset NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE
unset NEWRELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE
unset NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE
unset NEWRELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE
unset NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED
unset NEWRELIC_SPAN_EVENTS_MAX_SAMPLES_STORED
unset NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_PER_MINUTE
unset NEWRELIC_SPAN_EVENTS_MAX_SAMPLES_PER_MINUTE
unset NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST
unset NEWRELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST
unset NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_PORT
unset NEWRELIC_INFINITE_TRACING_TRACE_OBSERVER_PORT

# Instrumentation Controls
unset NEW_RELIC_INSTRUMENTATION_ENABLED
unset NEWRELIC_INSTRUMENTATION_ENABLED
unset NEW_RELIC_DISABLE_INSTRUMENTATION
unset NEWRELIC_DISABLE_INSTRUMENTATION
unset NEW_RELIC_DISABLE_PERFORMANCE_COUNTERS
unset NEWRELIC_DISABLE_PERFORMANCE_COUNTERS
unset NEW_RELIC_INSTRUMENT_ASSEMBLY
unset NEWRELIC_INSTRUMENT_ASSEMBLY
unset NEW_RELIC_IGNORE_INSTRUMENT_ASSEMBLY
unset NEWRELIC_IGNORE_INSTRUMENT_ASSEMBLY
unset NEW_RELIC_INSTRUMENTATION_LOAD_PATHS
unset NEWRELIC_INSTRUMENTATION_LOAD_PATHS
unset NEW_RELIC_INSTRUMENTATION_DLL_PATH
unset NEWRELIC_INSTRUMENTATION_DLL_PATH
unset NEW_RELIC_DISABLE_ADO_INSTRUMENTATION
unset NEWRELIC_DISABLE_ADO_INSTRUMENTATION
unset NEW_RELIC_DISABLE_ASP_INSTRUMENTATION
unset NEWRELIC_DISABLE_ASP_INSTRUMENTATION
unset NEW_RELIC_DISABLE_ASPNETCORE_INSTRUMENTATION
unset NEWRELIC_DISABLE_ASPNETCORE_INSTRUMENTATION
unset NEW_RELIC_DISABLE_AZURE_INSTRUMENTATION
unset NEWRELIC_DISABLE_AZURE_INSTRUMENTATION
unset NEW_RELIC_DISABLE_MSSQL_INSTRUMENTATION
unset NEWRELIC_DISABLE_MSSQL_INSTRUMENTATION
unset NEW_RELIC_DISABLE_POSTGRES_INSTRUMENTATION 
unset NEWRELIC_DISABLE_POSTGRES_INSTRUMENTATION
unset NEW_RELIC_DISABLE_MYSQL_INSTRUMENTATION
unset NEWRELIC_DISABLE_MYSQL_INSTRUMENTATION
unset NEW_RELIC_DISABLE_MONGODB_INSTRUMENTATION
unset NEWRELIC_DISABLE_MONGODB_INSTRUMENTATION
unset NEW_RELIC_DISABLE_REDIS_INSTRUMENTATION
unset NEWRELIC_DISABLE_REDIS_INSTRUMENTATION
unset NEW_RELIC_DISABLE_RABBITMQ_INSTRUMENTATION
unset NEWRELIC_DISABLE_RABBITMQ_INSTRUMENTATION
unset NEW_RELIC_DISABLE_HTTP_INSTRUMENTATION
unset NEWRELIC_DISABLE_HTTP_INSTRUMENTATION
unset NEW_RELIC_DISABLE_WCFCLIENT_INSTRUMENTATION
unset NEWRELIC_DISABLE_WCFCLIENT_INSTRUMENTATION
unset NEW_RELIC_DISABLE_WCFSERVICE_INSTRUMENTATION
unset NEWRELIC_DISABLE_WCFSERVICE_INSTRUMENTATION
unset NEW_RELIC_DISABLE_SIGNALR_INSTRUMENTATION
unset NEWRELIC_DISABLE_SIGNALR_INSTRUMENTATION
unset NEW_RELIC_DISABLE_GRPC_INSTRUMENTATION
unset NEWRELIC_DISABLE_GRPC_INSTRUMENTATION
unset NEW_RELIC_DISABLE_LAMBDA_INSTRUMENTATION
unset NEWRELIC_DISABLE_LAMBDA_INSTRUMENTATION
unset NEW_RELIC_DISABLE_EF6_INSTRUMENTATION
unset NEWRELIC_DISABLE_EF6_INSTRUMENTATION
unset NEW_RELIC_DISABLE_EFCORE_INSTRUMENTATION
unset NEWRELIC_DISABLE_EFCORE_INSTRUMENTATION
unset NEW_RELIC_DISABLE_GRAPHQL_INSTRUMENTATION
unset NEWRELIC_DISABLE_GRAPHQL_INSTRUMENTATION
unset NEW_RELIC_DISABLE_NHIBERNATE_INSTRUMENTATION
unset NEWRELIC_DISABLE_NHIBERNATE_INSTRUMENTATION
unset NEW_RELIC_DISABLE_STACKEXCHANGE_REDIS_INSTRUMENTATION
unset NEWRELIC_DISABLE_STACKEXCHANGE_REDIS_INSTRUMENTATION
unset NEW_RELIC_DISABLE_MASSTRANSIT_INSTRUMENTATION
unset NEWRELIC_DISABLE_MASSTRANSIT_INSTRUMENTATION
unset NEW_RELIC_DISABLE_NSERVICEBUS_INSTRUMENTATION
unset NEWRELIC_DISABLE_NSERVICEBUS_INSTRUMENTATION

# Cross Application Tracing
unset NEW_RELIC_CROSS_APPLICATION_TRACING
unset NEWRELIC_CROSS_APPLICATION_TRACING
unset NEW_RELIC_CROSS_PROCESS_ID
unset NEWRELIC_CROSS_PROCESS_ID
unset NEW_RELIC_ENCODING_KEY
unset NEWRELIC_ENCODING_KEY
unset NEW_RELIC_TRUSTED_ACCOUNT_IDS
unset NEWRELIC_TRUSTED_ACCOUNT_IDS

# Security
unset NEW_RELIC_SECURITY_POLICIES_TOKEN
unset NEWRELIC_SECURITY_POLICIES_TOKEN
unset NEW_RELIC_STRIP_EXCEPTION_MESSAGES
unset NEWRELIC_STRIP_EXCEPTION_MESSAGES
unset NEW_RELIC_SECURITY_AGENT_ENABLED
unset NEWRELIC_SECURITY_AGENT_ENABLED
unset CORECLR_PROFILER_PATH_64
unset CORECLR_PROFILER_PATH_32
unset CORECLR_PROFILER
unset CORECLR_ENABLE_PROFILING
unset COR_PROFILER_PATH_64
unset COR_PROFILER_PATH_32
unset COR_PROFILER
unset COR_ENABLE_PROFILING
unset COR_PROFILER_PATH
unset NEW_RELIC_PROFILING_ENABLED
unset NEWRELIC_PROFILING_ENABLED

# Process Host Metrics
unset NEW_RELIC_UTILIZATION_DETECT_AWS
unset NEWRELIC_UTILIZATION_DETECT_AWS
unset NEW_RELIC_UTILIZATION_DETECT_AZURE
unset NEWRELIC_UTILIZATION_DETECT_AZURE
unset NEW_RELIC_UTILIZATION_DETECT_GCP
unset NEWRELIC_UTILIZATION_DETECT_GCP
unset NEW_RELIC_UTILIZATION_DETECT_PCF
unset NEWRELIC_UTILIZATION_DETECT_PCF
unset NEW_RELIC_UTILIZATION_DETECT_DOCKER
unset NEWRELIC_UTILIZATION_DETECT_DOCKER
unset NEW_RELIC_UTILIZATION_DETECT_KUBERNETES
unset NEWRELIC_UTILIZATION_DETECT_KUBERNETES

# Serverless Mode
unset NEW_RELIC_SERVERLESS_MODE_ENABLED
unset NEWRELIC_SERVERLESS_MODE_ENABLED
unset NEW_RELIC_FUNCTION_NAME
unset NEWRELIC_FUNCTION_NAME
unset NEW_RELIC_FUNCTION_HANDLER
unset NEWRELIC_FUNCTION_HANDLER
unset NEW_RELIC_LAMBDA_EXTENSION_ENABLED
unset NEWRELIC_LAMBDA_EXTENSION_ENABLED
unset NEW_RELIC_LAMBDA_EXTENSION_PATH
unset NEWRELIC_LAMBDA_EXTENSION_PATH

# Synthetics
unset NEW_RELIC_SYNTHETICS_ENABLED
unset NEWRELIC_SYNTHETICS_ENABLED

# Custom Metrics
unset NEW_RELIC_CUSTOM_METRICS_ENABLED
unset NEWRELIC_CUSTOM_METRICS_ENABLED
unset NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED
unset NEWRELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED

# Miscellaneous
unset NEW_RELIC_PROFILER_LOG_DIRECTORY
unset NEWRELIC_PROFILER_LOG_DIRECTORY
unset NEW_RELIC_PROFILER_MEMORY_COLLECTOR_ENABLED
unset NEWRELIC_PROFILER_MEMORY_COLLECTOR_ENABLED
unset NEW_RELIC_ENVIRONMENT
unset NEWRELIC_ENVIRONMENT
unset NEW_RELIC_IGNORED_PARAMS
unset NEWRELIC_IGNORED_PARAMS
unset NEW_RELIC_IGNORED_STATUS_CODES
unset NEWRELIC_IGNORED_STATUS_CODES
unset NEW_RELIC_ENTITY_GUID
unset NEWRELIC_ENTITY_GUID
unset NEW_RELIC_APP_DOMAIN_TIMEOUT
unset NEWRELIC_APP_DOMAIN_TIMEOUT
unset NEW_RELIC_CIRCUIT_BREAKER_ENABLED
unset NEWRELIC_CIRCUIT_BREAKER_ENABLED
unset NEW_RELIC_WAIT_FOR_FULL_IIS
unset NEWRELIC_WAIT_FOR_FULL_IIS

e# Now use the function to catch any other variables with NEW_RELIC_ prefix
echo "Checking for any additional NEW_RELIC_ variables..."
unset_vars_with_prefix "NEW_RELIC_"

# Also check for NEWRELIC_ prefix (without underscore)
echo "Checking for any additional NEWRELIC_ variables..."
unset_vars_with_prefix "NEWRELIC_"

echo "All New Relic environment variables have been unset."
echo "Remember to restart your application for these changes to take effect."